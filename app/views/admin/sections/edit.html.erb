<div class='js-class-admin-edit-section-page' />

<%= form_for form, url: admin_part_section_path, method: :patch do |f| %>

  <div class='fieldset'>
    <div class='field'>
      <%= f.label :title, 'Title' %>
      <%= f.text_field :title %>
      <% f.object.errors[:title].each do |error| %>
        <%= error %>
      <% end %>
    </div>
  </div>

  <% if f.object.model.versions.any? %>
    <div class='fieldset'>
      <label>Versions</label>
      <div>
        <%= f.fields_for :versions, include_id: false do |vf| %>
          <% if vf.object.id %>
            <%= render('existing_version_form', vf: vf) %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>

  <div class='fieldset'>
    <%= f.fields_for :versions do |vf| %>
      <% unless vf.object.id %>
        <% if vf.object.document_cache || vf.object.errors.present? %>
          <%= render('new_version_form', vf: vf) %>
          <%= link_to 'Undo', '#', id: 'add_new_version_toggle', data: {closed: false, form: render('new_version_form', vf: vf)} %>
        <% else %>
          <%= link_to 'Add new version', '#', id: 'add_new_version_toggle', data: {closed: true, form: render('new_version_form', vf: vf)} %>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class='actions'>
    <%= f.submit 'Update' %>
  </div>

<% end %>
